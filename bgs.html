<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>VIP • TEACHER</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%;font-family:"Outfit",system-ui,arial;background:#0d0f1a;color:#fff;overflow:hidden;}
iframe.bg{position:fixed;inset:0;width:100%;height:100%;border:0;z-index:0}

/* Floating button */
.float{position:fixed;bottom:12px;right:12px;width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#00ffa3,#2ee6ff);box-shadow:0 10px 20px rgba(0,0,0,.45);cursor:pointer;user-select:none;touch-action:none;z-index:1200}
.float i{color:#000;font-size:15px}

/* Overlay panel */
.overlay{position:fixed;inset:0;display:none;align-items:flex-end;justify-content:center;background:rgba(0,0,0,.55);backdrop-filter:blur(4px);z-index:1100;padding-bottom:24px}
.panel{width:94%;max-width:360px;border-radius:12px;background:#1b1e2d;overflow:hidden;border:1px solid rgba(255,255,255,.03)}
.panel-head{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;font-weight:700;font-size:13px}
.panel-body{padding:12px;display:flex;flex-direction:column;gap:10px}

/* Info strip */
.info-strip{display:flex;justify-content:space-between;align-items:center;padding:7px 10px;border-radius:8px;background:#141722;font-size:12px;color:#cbd5e1}
.info-strip .next{font-weight:800}

/* Result box */
.result-box{display:flex;align-items:center;justify-content:center;min-height:58px;border-radius:10px;padding:8px 10px;font-weight:900;background:#0c0f12;color:#fff;transition:all .32s ease}
.result-box.digit{font-size:36px;letter-spacing:6px}
.result-box.bigsmall{font-size:18px;letter-spacing:3px;padding:10px 12px}

/* Animations */
@keyframes pulseGlow{0%{transform:scale(.99);opacity:.85}50%{transform:scale(1.02);opacity:1}100%{transform:scale(.99);opacity:.92}}
.anim-pulse{animation:pulseGlow 1.2s infinite}
@keyframes cooldownGlow{0%{box-shadow:0 0 0 rgba(255,255,255,0);transform:scale(1)}50%{box-shadow:0 0 36px rgba(255,120,90,.10);transform:scale(1.02)}100%{box-shadow:0 0 0 rgba(255,255,255,0);transform:scale(1)}}
.anim-cooldown{animation:cooldownGlow 0.9s infinite}

/* Fade */
.fade-out{opacity:0;transform:translateY(-6px);transition:all .30s ease}
.fade-in{opacity:1;transform:translateY(0);transition:all .30s ease}

/* Server row */
.server-row{display:flex;align-items:center;justify-content:space-between;padding:8px;border-radius:8px;background:#0f1420;font-size:13px}
.server-state{font-weight:800}
.server-state.on{color:#00ffa3}
.server-state.off{color:#ff6b6b}

/* Toggle */
.toggle{position:relative;width:44px;height:22px;border-radius:999px;background:#232734;padding:3px;cursor:pointer}
.toggle .knob{position:absolute;top:3px;left:3px;width:16px;height:16px;border-radius:50%;background:#fff;transition:transform .22s}
.toggle.on{background:linear-gradient(90deg,#00ffa3,#2ee6ff)}
.toggle.on .knob{transform:translateX(20px)}

/* Switch button */
.button-row{display:flex;gap:8px}
.btn{flex:1;height:36px;border-radius:16px;border:0;font-size:13px;font-weight:800;cursor:pointer;transition:transform .12s}
.btn:active{transform:translateY(1px)}
.switch-btn{background:linear-gradient(90deg,#ffd36b,#ff7b7b);color:#111}

/* Countdown overlay */
.countdown-full{position:fixed;left:50%;bottom:52%;transform:translate(-50%,50%);display:none;z-index:1400}
.countdown-full .num{font-size:64px;font-weight:900;color:#fff;text-shadow:0 6px 36px rgba(0,0,0,.6)}

/* Toast */
.toast{position:fixed;left:50%;bottom:10%;transform:translateX(-50%);padding:8px 12px;border-radius:8px;font-size:13px;opacity:0;transition:.20s;z-index:1500;background:#0f1420;color:#fff}
.toast.show{opacity:1}
</style>
</head>
<body>
<iframe class="bg" src="https://win-99.cfd/#/register?invitationCode=629124075780"></iframe>

<div class="float" id="floatBtn" title="Open panel"><i class="fa-solid fa-play"></i></div>

<div class="overlay" id="overlay">
  <div class="panel" id="panelEl">
    <div class="panel-head">
      <div id="panelTitle">VIP • TEACHER</div>
      <div style="display:flex;align-items:center;gap:8px">
        <button class="mode-btn" id="modeBtn" title="Theme"><i class="fa-solid fa-adjust"></i></button>
      </div>
    </div>
    <div class="panel-body">
      <div class="info-strip">
        <div>Period: <span id="periodNumber">—</span></div>
        <div class="next">Next in <span id="timerText">00:00</span></div>
      </div>
      <div id="resultText" class="result-box digit">—</div>
      <div class="server-row">
        <div class="server-state off" id="serverStateText">Disconnected</div>
        <div class="toggle" id="toggleWrap"><div class="knob"></div></div>
      </div>
      <div class="button-row">
        <button class="btn switch-btn" id="modeSwitchBtn">Switch to Big/Small</button>
      </div>
    </div>
  </div>
</div>

<div class="countdown-full" id="countdownFull"><div class="num" id="countdownNum">5</div></div>
<div class="toast" id="toast"></div>

<script>
const PREDICT_SECONDS=5;
let serverOn=false,gameMode='digit',currentValue=null,nextValue=null,cooldown=false,roundTimeout=null,uiTimer=null;

/* ELEMENTS */
const floatBtn=document.getElementById('floatBtn');
const overlay=document.getElementById('overlay');
const panelEl=document.getElementById('panelEl');
const resultText=document.getElementById('resultText');
const periodNumberEl=document.getElementById('periodNumber');
const timerText=document.getElementById('timerText');
const countdownFull=document.getElementById('countdownFull');
const countdownNum=document.getElementById('countdownNum');
const toggleWrap=document.getElementById('toggleWrap');
const serverStateText=document.getElementById('serverStateText');
const modeSwitchBtn=document.getElementById('modeSwitchBtn');
const toastEl=document.getElementById('toast');

function toast(msg){toastEl.textContent=msg;toastEl.classList.add('show');setTimeout(()=>toastEl.classList.remove('show'),1400);}
function pickValue(){return gameMode==='digit'?String(Math.floor(Math.random()*10)):(Math.random()<0.5?'BIG':'SMALL');}
function showValue(){resultText.textContent=currentValue;}

/* Floating drag */
let isPointerDown=false,startX=0,startY=0,startLeft=0,startTop=0,moved=false;
floatBtn.addEventListener('pointerdown',e=>{isPointerDown=true;moved=false;floatBtn.setPointerCapture?.(e.pointerId);const r=floatBtn.getBoundingClientRect();if(!floatBtn.style.left) floatBtn.style.left=r.left+'px';if(!floatBtn.style.top) floatBtn.style.top=r.top+'px';startX=e.clientX;startY=e.clientY;startLeft=parseFloat(floatBtn.style.left);startTop=parseFloat(floatBtn.style.top);});
window.addEventListener('pointermove',e=>{if(!isPointerDown)return;const dx=e.clientX-startX,dy=e.clientY-startY;if(Math.hypot(dx,dy)>6)moved=true;if(moved){let x=startLeft+dx,y=startTop+dy;x=Math.max(6,Math.min(window.innerWidth-floatBtn.offsetWidth-6,x));y=Math.max(6,Math.min(window.innerHeight-floatBtn.offsetHeight-6,y));floatBtn.style.left=x+'px';floatBtn.style.top=y+'px';floatBtn.style.right='auto';floatBtn.style.bottom='auto';}});
window.addEventListener('pointerup',e=>{if(!isPointerDown)return;isPointerDown=false;floatBtn.releasePointerCapture?.(e.pointerId);if(!moved) overlay.style.display='flex';});
overlay.addEventListener('click',e=>{if(e.target===overlay) overlay.style.display='none';});

/* Server toggle */
function setServer(on){serverOn=on;toggleWrap.classList.toggle('on',on);serverStateText.textContent=on?'Connected':'Disconnected';serverStateText.className='server-state '+(on?'on':'off');if(on){currentValue=pickValue();nextValue=pickValue();showValue();scheduleNextRound();startUiTimer();resultText.style.display='flex';}else{if(roundTimeout) clearTimeout(roundTimeout);stopUiTimer();resultText.style.display='none';countdownFull.style.display='none';}}
toggleWrap.addEventListener('click',()=>{setServer(!serverOn);toast(serverOn?'Server Connected':'Server Disconnected');});

/* Mode switch */
modeSwitchBtn.addEventListener('click',()=>{if(!cooldown){gameMode=gameMode==='digit'?'bigsmall':'digit';currentValue=pickValue();nextValue=pickValue();showValue();toast('Mode switched');}});
modeSwitchBtn.textContent='Switch to Big/Small';

/* UI timer */
function startUiTimer(){if(uiTimer) clearInterval(uiTimer);uiTimer=setInterval(()=>{const now=new Date();const s=now.getUTCSeconds();const remain=60-s;periodNumberEl.textContent=`${now.getUTCFullYear()}${String(now.getUTCMonth()+1).padStart(2,'0')}${String(now.getUTCDate()).padStart(2,'0')}1000${10001+now.getUTCHours()*60+now.getUTCMinutes()}`;timerText.textContent=`00:${String(remain).padStart(2,'0')}`;if(!serverOn)return;if(remain<=PREDICT_SECONDS&&remain>=1){countdownFull.style.display='block';countdownNum.textContent=String(remain);resultText.classList.add('anim-cooldown');resultText.classList.remove('anim-pulse');cooldown=true;}else{countdownFull.style.display='none';resultText.classList.remove('anim-cooldown');resultText.classList.add('anim-pulse');if(cooldown){currentValue=nextValue;nextValue=pickValue();showValue();}cooldown=false;}},250);}
function stopUiTimer(){if(uiTimer){clearInterval(uiTimer);uiTimer=null;}}

/* Next round */
function scheduleNextRound(){if(roundTimeout) clearTimeout(roundTimeout);const now=new Date();const msToNext=(60-now.getUTCSeconds())*1000-now.getUTCMilliseconds();roundTimeout=setTimeout(()=>{if(!cooldown){currentValue=nextValue;nextValue=pickValue();showValue();}scheduleNextRound();},msToNext>0?msToNext:msToNext+60000);}

/* Start server connected */
setServer(true);
</script>
</body>
</html>